<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@600&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', system-ui, sans-serif; padding: 40px; background: #e0e0e0; }
    h2 { margin-bottom: 20px; }
    h3 { margin: 30px 0 10px; color: #333; }
    #output { font-family: monospace; white-space: pre; background: #f5f5f5; padding: 20px; margin-top: 20px; font-size: 12px; }

    /* Outbox styles for visual inspection */
    .outbox-container { position: relative; display: inline-block; margin: 20px 0; }
    .outbox { position: absolute; border: 2px dashed; pointer-events: none; }
    .outbox-banner { border-color: red; }
    .outbox-logo { border-color: blue; }
    .outbox-text { border-color: green; }
    .outbox-content { border-color: magenta; }

    .legend { display: flex; gap: 20px; margin: 10px 0; font-size: 14px; }
    .legend-item { display: flex; align-items: center; gap: 5px; }
    .legend-box { width: 20px; height: 20px; border: 2px dashed; }

    /* Scale indicator */
    .scale-ruler { margin: 20px 0; }
    .ruler { height: 20px; background: repeating-linear-gradient(90deg, #000 0px, #000 1px, transparent 1px, transparent 10px); position: relative; }
    .ruler-label { display: flex; justify-content: space-between; font-size: 10px; }
  </style>
</head>
<body>
  <h2>Element Measurement with Outboxes</h2>

  <div class="legend">
    <div class="legend-item"><div class="legend-box" style="border-color: red;"></div> Banner</div>
    <div class="legend-item"><div class="legend-box" style="border-color: blue;"></div> Logo</div>
    <div class="legend-item"><div class="legend-box" style="border-color: green;"></div> Text</div>
    <div class="legend-item"><div class="legend-box" style="border-color: magenta;"></div> SVG Content</div>
  </div>

  <h3>Banner with Outboxes (Light)</h3>
  <div class="outbox-container" id="banner-container-light">
    <div id="banner-light" style="display: inline-flex; align-items: center; gap: 12px; padding: 4px 8px 4px 0; background: #f8fafc;">
      <img id="banner-logo-light" src="../suews-logo.svg" width="56" height="56">
      <span id="banner-text-light" style="font-family: 'Inter', system-ui, sans-serif; font-weight: 600; font-size: 42px; letter-spacing: -0.02em; color: #1a1d2e;">SUEWS</span>
    </div>
  </div>

  <h3>Banner with Outboxes (Dark)</h3>
  <div class="outbox-container" id="banner-container-dark">
    <div id="banner-dark" style="display: inline-flex; align-items: center; gap: 12px; padding: 4px 8px 4px 0; background: #1a1d2e;">
      <img id="banner-logo-dark" src="../suews-logo.svg" width="56" height="56">
      <span id="banner-text-dark" style="font-family: 'Inter', system-ui, sans-serif; font-weight: 600; font-size: 42px; letter-spacing: -0.02em; color: #ffffff;">SUEWS</span>
    </div>
  </div>

  <h3>SVG Logo with Content Bounds (200x200)</h3>
  <div class="outbox-container" id="svg-container">
    <svg id="svg-display" width="200" height="200" viewBox="0 0 2048 2048" style="background: #f8fafc; border: 1px solid #ccc;"></svg>
  </div>

  <h3>Scale Ruler (pixels)</h3>
  <div class="scale-ruler">
    <div class="ruler" style="width: 200px;"></div>
    <div class="ruler-label" style="width: 200px;">
      <span>0</span><span>50</span><span>100</span><span>150</span><span>200</span>
    </div>
  </div>

  <div id="output"></div>

  <script>
    window.onload = async function() {
      await document.fonts.ready;
      const output = [];

      // Helper to create outbox overlay
      function createOutbox(container, rect, className, label) {
        const containerRect = container.getBoundingClientRect();
        const outbox = document.createElement('div');
        outbox.className = `outbox ${className}`;
        outbox.style.left = (rect.left - containerRect.left) + 'px';
        outbox.style.top = (rect.top - containerRect.top) + 'px';
        outbox.style.width = rect.width + 'px';
        outbox.style.height = rect.height + 'px';

        // Add dimension labels
        const labelEl = document.createElement('div');
        labelEl.style.cssText = 'position: absolute; top: -18px; left: 0; font-size: 10px; color: ' +
          (className.includes('banner') ? 'red' : className.includes('logo') ? 'blue' : className.includes('text') ? 'green' : 'magenta');
        labelEl.textContent = `${label}: ${rect.width.toFixed(1)}x${rect.height.toFixed(1)}`;
        outbox.appendChild(labelEl);

        container.appendChild(outbox);
        return outbox;
      }

      // Measure and draw outboxes for light banner
      const containerLight = document.getElementById('banner-container-light');
      const bannerLight = document.getElementById('banner-light');
      const logoLight = document.getElementById('banner-logo-light');
      const textLight = document.getElementById('banner-text-light');

      const bannerLightRect = bannerLight.getBoundingClientRect();
      const logoLightRect = logoLight.getBoundingClientRect();
      const textLightRect = textLight.getBoundingClientRect();

      createOutbox(containerLight, bannerLightRect, 'outbox-banner', 'Banner');
      createOutbox(containerLight, logoLightRect, 'outbox-logo', 'Logo');
      createOutbox(containerLight, textLightRect, 'outbox-text', 'Text');

      // Measure and draw outboxes for dark banner
      const containerDark = document.getElementById('banner-container-dark');
      const bannerDark = document.getElementById('banner-dark');
      const logoDark = document.getElementById('banner-logo-dark');
      const textDark = document.getElementById('banner-text-dark');

      const bannerDarkRect = bannerDark.getBoundingClientRect();
      const logoDarkRect = logoDark.getBoundingClientRect();
      const textDarkRect = textDark.getBoundingClientRect();

      createOutbox(containerDark, bannerDarkRect, 'outbox-banner', 'Banner');
      createOutbox(containerDark, logoDarkRect, 'outbox-logo', 'Logo');
      createOutbox(containerDark, textDarkRect, 'outbox-text', 'Text');

      // Output measurements
      output.push('=== BANNER LAYOUT (Light) ===');
      output.push(`Banner: ${bannerLightRect.width.toFixed(2)} x ${bannerLightRect.height.toFixed(2)}px`);
      output.push(`Logo:   ${logoLightRect.width.toFixed(2)} x ${logoLightRect.height.toFixed(2)}px at x=${(logoLightRect.left - bannerLightRect.left).toFixed(2)}`);
      output.push(`Text:   ${textLightRect.width.toFixed(2)} x ${textLightRect.height.toFixed(2)}px at x=${(textLightRect.left - bannerLightRect.left).toFixed(2)}`);
      output.push('');
      output.push('CSS Margins:');
      const leftPadding = logoLightRect.left - bannerLightRect.left;
      const gap = textLightRect.left - logoLightRect.right;
      const rightPadding = bannerLightRect.right - textLightRect.right;
      output.push(`  Left padding:  ${leftPadding.toFixed(2)}px`);
      output.push(`  Gap:           ${gap.toFixed(2)}px`);
      output.push(`  Right padding: ${rightPadding.toFixed(2)}px`);

      // Calculate SVG internal margins (at 56px size)
      // SVG viewBox is 2048x2048, content left margin is ~290
      const svgInternalLeftMargin = (290 / 2048) * logoLightRect.width;
      const svgInternalRightMargin = (289.5 / 2048) * logoLightRect.width;
      output.push('');
      output.push('SVG internal margins (at rendered size):');
      output.push(`  SVG left whitespace:  ${svgInternalLeftMargin.toFixed(2)}px`);
      output.push(`  SVG right whitespace: ${svgInternalRightMargin.toFixed(2)}px`);

      // Visual margins (what the eye sees)
      const visualLeftMargin = leftPadding + svgInternalLeftMargin;
      const visualRightMargin = rightPadding;
      output.push('');
      output.push('VISUAL margins (CSS + SVG internal):');
      output.push(`  Visual left:  ${visualLeftMargin.toFixed(2)}px (${leftPadding.toFixed(2)} CSS + ${svgInternalLeftMargin.toFixed(2)} SVG)`);
      output.push(`  Visual right: ${visualRightMargin.toFixed(2)}px`);
      output.push(`  Symmetry check: left(${visualLeftMargin.toFixed(2)}) vs right(${visualRightMargin.toFixed(2)}) = diff ${Math.abs(visualLeftMargin - visualRightMargin).toFixed(2)}px`);
      output.push('');
      output.push('Design ratios:');
      output.push(`  Text height / Logo height: ${(textLightRect.height / logoLightRect.height * 100).toFixed(1)}%`);

      // SVG content analysis
      output.push('');
      output.push('=== SVG INTERNAL CONTENT ===');

      const response = await fetch('../suews-logo.svg');
      const svgText = await response.text();
      const parser = new DOMParser();
      const svgDoc = parser.parseFromString(svgText, 'image/svg+xml');
      const svgElement = svgDoc.querySelector('svg');

      // Clone SVG into display element
      const svgDisplay = document.getElementById('svg-display');
      const clonedSvg = svgElement.cloneNode(true);
      while (clonedSvg.firstChild) {
        svgDisplay.appendChild(clonedSvg.firstChild);
      }

      // Get bounding box of content group
      const gElement = svgDisplay.querySelector('g');
      if (gElement) {
        const bbox = gElement.getBBox();
        const transformAttr = gElement.getAttribute('transform') || '';
        const translateMatch = transformAttr.match(/translate\(\s*(-?\d+(?:\.\d+)?)\s*,?\s*(-?\d+(?:\.\d+)?)?\s*\)/);
        const translateX = translateMatch ? parseFloat(translateMatch[1]) : 0;
        const translateY = translateMatch && translateMatch[2] ? parseFloat(translateMatch[2]) : 0;

        // Calculate rendered bounds in viewBox coordinates
        const renderedLeft = bbox.x + translateX;
        const renderedRight = renderedLeft + bbox.width;
        const renderedTop = bbox.y + translateY;
        const renderedBottom = renderedTop + bbox.height;
        const renderedCenterX = renderedLeft + bbox.width / 2;
        const renderedCenterY = renderedTop + bbox.height / 2;

        // ViewBox is 0,0 to 2048,2048
        const viewBoxWidth = 2048;
        const viewBoxHeight = 2048;
        const marginLeft = renderedLeft;
        const marginRight = viewBoxWidth - renderedRight;
        const marginTop = renderedTop;
        const marginBottom = viewBoxHeight - renderedBottom;

        output.push(`Transform: ${transformAttr}`);
        output.push(`Content local bbox: x=${bbox.x.toFixed(2)}, y=${bbox.y.toFixed(2)}, w=${bbox.width.toFixed(2)}, h=${bbox.height.toFixed(2)}`);
        output.push('');
        output.push('Rendered bounds (with transform):');
        output.push(`  Left:   ${renderedLeft.toFixed(2)}`);
        output.push(`  Right:  ${renderedRight.toFixed(2)}`);
        output.push(`  Top:    ${renderedTop.toFixed(2)}`);
        output.push(`  Bottom: ${renderedBottom.toFixed(2)}`);
        output.push('');
        output.push('ViewBox margins:');
        output.push(`  Left margin:   ${marginLeft.toFixed(2)}`);
        output.push(`  Right margin:  ${marginRight.toFixed(2)}`);
        output.push(`  Top margin:    ${marginTop.toFixed(2)}`);
        output.push(`  Bottom margin: ${marginBottom.toFixed(2)}`);
        output.push('');
        output.push('Symmetry check:');
        output.push(`  Horizontal: left(${marginLeft.toFixed(2)}) vs right(${marginRight.toFixed(2)}) = diff ${Math.abs(marginLeft - marginRight).toFixed(2)}`);
        output.push(`  Vertical:   top(${marginTop.toFixed(2)}) vs bottom(${marginBottom.toFixed(2)}) = diff ${Math.abs(marginTop - marginBottom).toFixed(2)}`);
        output.push('');
        output.push(`Center: x=${renderedCenterX.toFixed(2)}, y=${renderedCenterY.toFixed(2)} (viewBox center: 1024, 1024)`);
        output.push(`Offset from center: x=${(renderedCenterX - 1024).toFixed(2)}, y=${(renderedCenterY - 1024).toFixed(2)}`);

        // Draw content bounds rectangle in SVG
        const scale = 200 / 2048;
        const contentRect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
        contentRect.setAttribute('x', renderedLeft);
        contentRect.setAttribute('y', renderedTop);
        contentRect.setAttribute('width', bbox.width);
        contentRect.setAttribute('height', bbox.height);
        contentRect.setAttribute('fill', 'none');
        contentRect.setAttribute('stroke', 'magenta');
        contentRect.setAttribute('stroke-width', '20');
        contentRect.setAttribute('stroke-dasharray', '40,20');
        svgDisplay.appendChild(contentRect);

        // Draw center crosshair
        const crossSize = 100;
        const vLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        vLine.setAttribute('x1', 1024); vLine.setAttribute('y1', 1024 - crossSize);
        vLine.setAttribute('x2', 1024); vLine.setAttribute('y2', 1024 + crossSize);
        vLine.setAttribute('stroke', 'red'); vLine.setAttribute('stroke-width', '10');
        svgDisplay.appendChild(vLine);

        const hLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        hLine.setAttribute('x1', 1024 - crossSize); hLine.setAttribute('y1', 1024);
        hLine.setAttribute('x2', 1024 + crossSize); hLine.setAttribute('y2', 1024);
        hLine.setAttribute('stroke', 'red'); hLine.setAttribute('stroke-width', '10');
        svgDisplay.appendChild(hLine);

        // Draw content center
        const cLine1 = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        cLine1.setAttribute('x1', renderedCenterX - 60); cLine1.setAttribute('y1', renderedCenterY - 60);
        cLine1.setAttribute('x2', renderedCenterX + 60); cLine1.setAttribute('y2', renderedCenterY + 60);
        cLine1.setAttribute('stroke', 'cyan'); cLine1.setAttribute('stroke-width', '10');
        svgDisplay.appendChild(cLine1);

        const cLine2 = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        cLine2.setAttribute('x1', renderedCenterX + 60); cLine2.setAttribute('y1', renderedCenterY - 60);
        cLine2.setAttribute('x2', renderedCenterX - 60); cLine2.setAttribute('y2', renderedCenterY + 60);
        cLine2.setAttribute('stroke', 'cyan'); cLine2.setAttribute('stroke-width', '10');
        svgDisplay.appendChild(cLine2);
      }

      document.getElementById('output').textContent = output.join('\n');
    };
  </script>
</body>
</html>
