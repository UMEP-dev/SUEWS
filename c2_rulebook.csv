pipeline,rule_type,rule_name,trigger_condition,validation_logic,validation_source,trigger_parameters,affected_parameters,additional notes
A,cross_parameter,physics_options_presence,model.physics present,detect presence/absence (or renamed keys) of critical physics options early and add them to the updated YAML,phase_a.py:PHYSICS_OPTIONS & is_physics_option,model.physics,model.physics,
A,cross_parameter,nlayer_dimension_match,nlayer specified,"validates vertical-layer array dimensions vs nlayer: veg_frac/veg_scale/building_frac/building_scale must have nlayer elements; height must have nlayer+1; roofs/walls must contain nlayer substructures. If too short, pads with nulls (or null-template substructures) and records dimension_errors; if too long, records error (does not trim).",phase_a.py:validate_nlayer_dimensions,nlayer; veg_frac; veg_scale; building_frac; building_scale; height,nlayer; veg_frac; veg_scale; building_frac; building_scale; height,
A,data_validation,forcing_data_validation,forcing_file specified,"validates forcing data file(s) referenced in YAML: checks existence, handles RefValue/list entries, loads files and runs quality checks  (missing critical vars, NaNs, physical ranges, irregular time steps), adds filename context; returns (forcing_errors, forcing_file_paths); can be disabled via --forcing off",phase_a.py:validate_forcing_data,forcing_file,forcing_file,
B,conditional_required,physics_parameters_completeness,always triggered,validates that all critical physics parameters are present and non-null,phase_b.py:validate_physics_parameters,model.physics,model.physics,
B,cross_parameter,model_option_dependencies,always triggered,validates interdependency rules between physics options: rslmethod==2 requires stabilitymethod==3; stabilitymethod==1 requires rslmethod present; storageheatmethod==1 requires ohmincqf==0,phase_b.py:validate_model_option_dependencies,rslmethod; stabilitymethod; storageheatmethod; ohmincqf,rslmethod; stabilitymethod; storageheatmethod; ohmincqf,
B,cross_parameter,land_cover_consistency,always triggered,"validates that land_cover exists; sums surface fractions read from land_cover.sfr.value and checks sum ≈ 1.0 (tolerance abs(diff) > 1e-4; if sum == 0.0 reports error ""All surface fractions are zero or missing""; otherwise reports ERROR showing current sum and suggests adjusting the largest surface fraction (does not auto-correct). Collects active surfaces (sfr>0) and reports missing/incomplete surface parameters when detected",phase_b.py:validate_land_cover_consistency,paved.sfr; bldgs.sfr; evetr.sfr; dectr.sfr; grass.sfr; bsoil.sfr; water.sfr,paved.sfr; bldgs.sfr; evetr.sfr; dectr.sfr; grass.sfr; bsoil.sfr; water.sfr,
B,scientific_adjustment,land_cover_auto_correction,always triggered,compute sfr_sum; if 0.9999 <= sfr_sum < 1.0 increase largest sfr; if 1.0 < sfr_sum <= 1.0001 decrease largest sfr; when a correction is applied write back to land_cover[<max_surface>].sfr.value and report; if abs(sfr_sum - 1.0) > 1e-4 do not auto-fix and emit an error instead,phase_b.py:adjust_land_cover_fractions,paved.sfr; bldgs.sfr; evetr.sfr; dectr.sfr; grass.sfr; bsoil.sfr; water.sfr,paved.sfr; bldgs.sfr; evetr.sfr; dectr.sfr; grass.sfr; bsoil.sfr; water.sfr,
B,physical_constraint,geographic_validation,always triggered,"validates geographic coordinates are numeric and in valid ranges (lat: -90 to 90, lng: -180 to 180) and calculates timezone/DST if missing (may then populate startdls/enddls)",phase_b.py:validate_geographic_parameters,lat; lng; timezone; startdls; enddls,lat; lng; timezone; startdls; enddls,
B,scientific_adjustment,temperature_adjustment,needs start_date and CRU data available,"automatically sets initial surface temperatures using CRU monthly/annual means for the simulation start month and site location: updates initial_states.<surface>.temperature (5-layer), tsfc, tin where present; sets stebbs.InitialOutdoorTemperature to monthly mean and stebbs.DeepSoilTemperature to CRU annual mean",phase_b.py:adjust_surface_temperatures,start_time; lat; lng,temperature; tin; tsfc; InitialOutdoorTemperature; DeepSoilTemperature,
B,scientific_adjustment,seasonal_adjustment,season-dependent,"applies season-dependent adjustments: nullifies initial_states.snowalb for summer/tropical/equatorial; sets initial_states.dectr.lai_id from dectr.lai.laimin/laimax (summer=laimax, winter=laimin, spring/fall=average, tropical=laimax) only when dectr.sfr>0; skips surfaces with sfr==0",phase_b.py:adjust_seasonal_parameters,start_time; lat; dectr.sfr; dectr.lai.laimin; dectr.lai.laimax,"snowalb, lai_id",
B,scientific_adjustment,carbon_nullification,"emissionsmethod in {0,1,2,3,4}",automatically nullifies CO2-related site parameters (including day/hourly profiles and the listed *_bioco2 keys); record the nullified values in the report.,phase_b.py:adjust_model_dependent_nullification,emissionsmethod,"all CO2 block along with alpha_bioco2, alpha_enh_bioco2, beta_bioco2, beta_enh_bioco2, theta_bioco2, min_res_bioco2",
B,scientific_adjustment,stebbs_nullification,stebbsmethod==0,automatically nullifies all STEBBS parameters (including stebbs and building_archetype blocks); ); record the nullified values in the report.,phase_b.py:adjust_model_dependent_nullification,stebbsmethod,all STEBBS parameters,
B,cross_parameter,irrigation_validation,ie_start or ie_end specified,validates irrigation DOY parameters per site: ensures ie_start and ie_end are both present or both absent; checks DOY range (1..365 or 366 depending on model_year); enforces pairing and emits ERRORs for missing/invalid values; applies hemisphere-aware seasonal checks (Northern Hemisphere typical warm season ≈ DOY 121–273; Southern Hemisphere warm season usually year‑wrapping — non‑wrapping SH periods flagged as WARNING); detects unusual year‑wrapping patterns,phase_b.py:validate_irrigation_parameters,"ie_start, ie_end, lat, start_time",ie_start; ie_end,
B,cross_parameter,dls_calculation,startdls or enddls specified,"validates DOY values for startdls/enddls (consistency both set or both None), enforces DOY range and leap‑year rules (DOY 366 only allowed in leap years when model_year known), compares user values to location‐based calculated DLS and records INFO/WARNING messages; populate startdls/enddls when missing or different from the calculated ones",phase_b.py:validate_dls_doy / DLSCheck helpers,start_time; lat; lng,startdls; enddls,
C/Pydantic,conditional_required,parameter_completeness,always triggered,"validates all site parameters are complete; runs site-by-site checks and conditional validations (STEBBS, RSL, storage)",config.py:validate_parameter_completeness,model.physics; site.properties.,all site properties; all model physics options,
C/Pydantic,conditional_required,stebbs_completeness,stebbsmethod == 1,all STEBBS parameters must be present and non-null when stebbsmethod=1,config.py:_validate_stebbs,stebbsmethod,all STEBBS parameters,
C/Pydantic,conditional_required,rsl_faibldg_required,rslmethod == 2 & bldgs.sfr > 0,"when rslmethod=2 and buildings present (bldgs.sfr > 0), faibldg parameter must be set",config.py:_validate_rsl,rslmethod; bldgs.sfr,faibldg,
C/Pydantic,conditional_required,storage_validation,storageheatmethod == 6,"validate that walls[0].thermal_layers contains non-empty numeric lists for dz, k and rho_cp; require properties.lambda_c to be set and non-null",config.py:_validate_storage,storageheatmethod,"vertical_layers.walls[0].thermal_layers.dz; vertical_layers.walls[0].thermal_layers.k; vertical_layers.walls[0].thermal_layers.rho_cp, properties.lambda_c",
C/Pydantic,conditional_required,critical_physics_nonnull,always triggered,critical physics parameters must be non-null,config.py:_check_critical_null_physics_params,model.physics,model.physics,
C/Pydantic,conditional_required,site_required_fields,always triggered,critical site fields must be non-null and valid; enforces physical constraint z0m_in < zdm_in,config.py:validate_site_required_fields,lat; lng; alt; timezone; surfacearea; z; z0m_in; zdm_in; pipecapacity; runofftowater; narp_trans_site,lat; lng; alt; timezone; surfacearea; z; z0m_in; zdm_in; pipecapacity; runofftowater; narp_trans_site,it also check sthat top-level fields are non-null (but not nested params): lumps; spartacus; conductance; irrigation; anthropogenic_emissions; snow; land_cover; vertical_layers
C/Pydantic,cross_parameter,radiation_forcing_compatibility,netradiationmethod == 1 & forcing_file looks like sample,"warns if netradiationmethod=1 (needs observed Ldown) but forcing file appears to be sample data (filenames containing ""forcing.txt"", ""sample_forcing.txt"" or ""test_forcing.txt"")",config.py:validate_model_radiation_method,"netradiationmethod, forcing_file","netradiationmethod, forcing_file",
C/Pydantic,physical_constraint,output_config_validation,output_file is OutputConfig,output frequency must be positive and a multiple of timestep,config.py:validate_model_output_config,tstep; freq,tstep; freq,
C/Pydantic,field_transformation,output_groups_validation,groups specified,"validates output groups against allowed set: {SUEWS, DailyState, snow, ESTM, RSL, BL, debug, SPARTACUS, EHC, STEBBS}",model.py:validate_groups,groups,groups,
C/Pydantic,field_transformation,numeric_type_conversion,always triggered,converts numpy float/int types to Python native float/int for tstep and diagnose,model.py:validate_int_float,"tstep, diagnose","tstep, diagnose",
C/Pydantic,field_transformation,timezone_enum_conversion,timezone is numeric,converts numeric timezone offset values to TimezoneOffset enum,site.py:validate_timezone,timezone,timezone,
C/Pydantic,field_transformation,temperature_array_handling,temperature field present,ensures temperature is properly formatted as 5-element array for multi-layer surfaces,state.py:validate_temperature,temperature,temperature,
C/Pydantic,field_transformation,schedule_validation,schedule data present,"validates working_day and holiday format: converts keys to strings, ensures keys are integers 1–24 and that all hours 1..24 are present",profile.py:validate_working_day_holiday,working_day; holiday,working_day; holiday,
C/Pydantic,cross_parameter,dls_validation,startdls or enddls specified,"validates daylight saving time parameters: (1) consistency (both set or both None), (2) leap year refinement (DOY 366 only valid in leap years), (3) compares user values against calculated DLS and record informational messages if values differ",config.py:validate_dls_parameters,startdls; enddls; lat; start_time,startdls; enddls,
C/Pydantic,cross_parameter,vegetation_albedo_maxmin,always triggered,"enforces alb_min <= alb_max for evetr, dectr, grass",config.py:validate_albedo_ranges,alb_min; alb_max,alb_min; alb_max,
C/Pydantic,cross_parameter,deciduous_porosity_maxmin,always triggered,enforces pormin_dec < pormax_dec,config.py:validate_deciduous_porosity_ranges,pormin_dec; pormax_dec,pormin_dec; pormax_dec,