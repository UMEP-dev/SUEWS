identity:
  scheme_name: qf
  full_name: Anthropogenic Heat Flux
  category: emissions
  purpose: >-
    Calculates anthropogenic heat flux (QF) and associated CO2 emissions from
    human metabolism, building energy use, and road traffic using temperature-dependent
    parameterisations and diurnal activity profiles.
  version_introduced: "v1.0"
  original_authors:
    - "T. Loridan"
    - "L. Jarvi"
    - "H.C. Ward"
  enum_class: EmissionsMethod
  enum_values: [0, 1, 2, 3, 4, 5]

scientific_basis:
  theoretical_basis: >-
    Anthropogenic heat flux is decomposed into three components: human metabolism,
    building energy use, and road traffic. Each component is modulated by diurnal
    activity profiles that distinguish weekdays from weekends. The L11 family
    (methods 1, 3) uses a piecewise-linear relation between air temperature and
    QF, with heating contributions when temperature falls below a base threshold.
    Method 3 extends this by using daily mean temperature and adding a cooling
    (air-conditioning) term above a cooling threshold. The J11 family (method 2)
    uses heating and cooling degree days (HDD/CDD) with population-density-weighted
    empirical coefficients. The J19 family (methods 4, 5) calculates each component
    independently using building energy statistics, vehicle emission factors, and
    metabolic rates scaled by population density, allowing CO2 fluxes to be derived
    from local energy and transport data rather than inferred from total QF.
  key_publications:
    - "L11"
    - "J11"
    - "J19"
    - "A11"
    - "L13"
  key_assumptions:
    - "QF can be decomposed into metabolism, building, and traffic components"
    - "Diurnal profiles adequately capture sub-daily variation in anthropogenic activity"
    - "Population density (daytime and nighttime) is representative of the grid cell"
    - "Temperature-QF relationships are transferable across sites with recalibration"
    - "CO2 emissions scale with fossil fuel fraction and published emission factors"
  comparison_to_established: >-
    The built-in SAHP approaches provide a computationally lightweight alternative
    to dedicated anthropogenic heat models such as LUCY (LQF) and GreaterQF (GQF),
    which offer more detailed sectoral disaggregation but require substantially
    more input data. Pre-calculated QF from external models can be supplied via
    method 0 when higher fidelity is required.

evaluation_evidence:
  evaluation_status: peer-reviewed
  evaluation_datasets:
    - "Helsinki urban flux tower observations (Jarvi et al. 2011)"
    - "Multiple urban sites in North America and Europe (Loridan et al. 2011)"
  performance_summary: >-
    The L11 and J11 methods have been validated against eddy-covariance-derived
    residual QF at several urban flux tower sites. The J11 HDD/CDD formulation
    captures seasonal heating and cooling demand effectively in mid-latitude cities.
    The J19 component-based approach provides more physically transparent results
    but requires detailed local energy and transport statistics.

technical_characteristics:
  spatial_scale:
    - neighbourhood
    - city
  temporal_resolution:
    - sub-hourly
    - hourly
  required_inputs:
    parameters:
      - "Population density (daytime and nighttime) [cap ha-1]"
      - "QF empirical coefficients (Qf_A, Qf_B, Qf_C for J11)"
      - "Base temperatures for heating and cooling thresholds"
      - "AH_MIN and AH_SLOPE coefficients (for L11)"
      - "Building energy use fraction (QF0_BEU)"
      - "Fossil fuel fractions (heating and non-heating)"
      - "Traffic rate and emission factors (for J19)"
      - "Metabolic heat range (MinQFMetab, MaxQFMetab)"
      - "Diurnal profiles (anthropogenic heat, traffic, human activity, population)"
    forcing:
      - "Air temperature"
      - "Heating and cooling degree days (computed internally from temperature)"
  outputs:
    - "Total anthropogenic heat flux QF [W m-2]"
    - "Anthropogenic CO2 flux Fc_anthro [umol m-2 s-1]"
    - "Component fluxes: metabolism, building, traffic, point source"
  computational_demand: low
  data_preparation_demand: medium
  dependencies:
    - "Heating/cooling degree day calculation (internal daily state)"
    - "Diurnal profile interpolation (internal)"

operational_status:
  development_status: stable
  current_maintainers:
    - name: SUEWS Development Team
      affiliation: University of Reading / UCL
  last_significant_update: "2019-02"
  active_development: maintenance-only
  test_coverage:
    - "Smoke tests via make test-smoke"
    - "Full regression tests via make test"

user_guidance:
  recommended_for:
    - "Standard urban energy balance simulations requiring anthropogenic heat"
    - "Studies where QF magnitude and diurnal pattern matter but detailed sectoral breakdown is not essential"
    - "Long-duration runs where computational efficiency is important"
  not_recommended_for:
    - "Detailed sectoral energy demand studies (use LUCY/LQF or GreaterQF/GQF instead)"
    - "Sites with highly heterogeneous population distributions within a single grid cell"
  configuration_notes: >-
    EmissionsMethod 0 reads QF directly from the forcing file (set to zero to
    exclude QF). Methods 1-3 are QF-only schemes: 1 (L11) uses instantaneous
    air temperature, 2 (J11) uses HDD/CDD, 3 (L11_UPDATED) uses daily mean
    temperature with a cooling term. Methods 4-5 (J19 family) calculate each
    QF component independently from building energy and traffic data; method 5
    additionally computes anthropogenic CO2. Methods 3 and 5 are internal
    updates not yet independently published.
  common_pitfalls:
    - "Population density must be set for both daytime and nighttime; missing values lead to zero QF"
    - "Diurnal profiles must be normalised (sum to 1) for correct scaling"
    - "L11 coefficients (AH_MIN, AH_SLOPE) are site-specific and not directly transferable"
    - "J19 methods require traffic units to be consistent with emission factor units"

governance:
  candidate_for_deprecation: false
