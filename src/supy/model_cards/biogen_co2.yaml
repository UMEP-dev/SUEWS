identity:
  scheme_name: biogen_co2
  full_name: Biogenic CO2 Exchange
  category: co2_vegetation
  purpose: >-
    Calculates the biogenic component of the CO2 flux from vegetation
    photosynthesis and soil/vegetation respiration, combined with an
    anthropogenic QF method.
  version_introduced: "v2017a"
  original_authors:
    - "H.C. Ward"
    - "L. Jarvi"
    - "M. Hagelin"
  enum_class: EmissionsMethod
  enum_values: [11, 12, 13, 14, 15, 21, 22, 23, 24, 25, 41, 42, 43, 44, 45]

scientific_basis:
  theoretical_basis: >-
    Biogenic CO2 exchange is partitioned into photosynthetic uptake and
    ecosystem respiration. Photosynthesis is computed per vegetated surface
    type (coniferous trees, deciduous trees, grass), weighted by an active
    vegetation fraction derived from surface fraction, snow cover, and the
    ratio of current LAI to maximum LAI. Three photosynthesis model families
    are available. The rectangular hyperbola (methods 11-15) uses the classic
    light-response curve Fc = -beta*alpha*PAR / (alpha*PAR + beta), where
    alpha is the quantum yield and beta the maximum photosynthetic rate. The
    non-rectangular hyperbola (methods 21-25), following Bellucco et al. (2017),
    adds a curvature parameter theta that controls the sharpness of the
    light-saturation transition. The conductance-based approach (methods 41-45),
    following Jarvi et al. (2019), links photosynthetic uptake to the stomatal
    conductance model (g-function), making CO2 uptake respond to incoming
    radiation, temperature, humidity deficit, and soil moisture simultaneously.
    Respiration follows an exponential temperature dependence
    (R = a * exp(b * T)) with a configurable minimum floor, applied to each
    vegetated surface type. PAR is estimated from incoming shortwave radiation
    using standard conversion factors (PAR = 0.46 * Kdown * 4.6 umol J-1).
    Each biogenic method is paired with one of the QF anthropogenic heat
    methods (L11, J11, L11_UPDATED, J19, J19_UPDATED), yielding the combined
    EmissionsMethod values.
  key_publications:
    - "J19"
    - "B17"
  key_assumptions:
    - "Active vegetation fraction scales linearly with LAI/LAImax ratio"
    - "PAR is a fixed fraction (0.46) of incoming shortwave radiation"
    - "Soil respiration follows an exponential temperature dependence"
    - "Photosynthesis model parameters are constant per vegetation type within a run"
    - "Snow-covered vegetation is photosynthetically inactive"
  comparison_to_established: >-
    These schemes provide neighbourhood-scale biogenic CO2 estimates integrated
    within the SUEWS energy and water balance framework. They are simpler than
    dedicated vegetation models (e.g., JULES, CLM) but sufficient for urban
    applications where anthropogenic CO2 dominates and vegetation fluxes provide
    a secondary correction. The conductance-based method (41-45) offers the
    tightest coupling to the SUEWS stomatal conductance scheme.

evaluation_evidence:
  evaluation_status: internal
  evaluation_datasets:
    - "Helsinki urban eddy-covariance CO2 flux observations"
  performance_summary: >-
    Evaluated primarily against Helsinki flux tower data. The non-rectangular
    hyperbola and conductance-based approaches show improved representation
    of the light-response curve compared to the simple rectangular hyperbola,
    particularly at high irradiance. All methods remain experimental and
    require further multi-site validation before production use.

technical_characteristics:
  spatial_scale:
    - neighbourhood
    - city
  temporal_resolution:
    - sub-hourly
    - hourly
  required_inputs:
    parameters:
      - "Photosynthesis coefficients (alpha, beta per vegetation type)"
      - "Curvature parameter theta (non-rectangular hyperbola methods only)"
      - "Enhanced alpha/beta coefficients (general Bellucco model only)"
      - "Respiration coefficients (resp_a, resp_b per vegetation type)"
      - "Minimum respiration floor (min_res_bioCO2 per vegetation type)"
      - "LAI minimum and maximum per vegetation type"
      - "Surface fractions (7 surface types)"
      - "All parameters required by the paired QF method"
    forcing:
      - "Incoming shortwave radiation (Kdown)"
      - "Air temperature (or modelled 2 m temperature)"
      - "LAI (from phenology model or prescribed)"
      - "Snow fraction per surface type"
      - "Stomatal conductance g-function (conductance-based methods only)"
  outputs:
    - "Biogenic CO2 flux Fc_biogen [umol m-2 s-1]"
    - "Photosynthetic uptake Fc_photo [umol m-2 s-1]"
    - "Ecosystem respiration Fc_respi [umol m-2 s-1]"
    - "Anthropogenic CO2 flux (from paired QF method)"
  computational_demand: low
  data_preparation_demand: high
  dependencies:
    - "Phenology model (LAI calculation)"
    - "Snow model (snow fraction per surface)"
    - "Stomatal conductance model (g-function, for methods 41-45)"
    - "Anthropogenic heat scheme (paired QF method)"

operational_status:
  development_status: experimental
  current_maintainers:
    - name: SUEWS Development Team
      affiliation: University of Reading / UCL
  last_significant_update: "2019-02"
  active_development: maintenance-only
  test_coverage:
    - "Integration tests via make test"
  known_issues:
    - "Code comments note potential bugs and incomplete documentation"
    - "Active vegetation fraction drops to zero at LAI minimum, which may be unrealistic for evergreen species"
    - "General Bellucco model (methods 31-36) not currently exposed via enum; may include anthropogenic contamination"
    - "Weekend population handling uses nighttime values throughout the day"

user_guidance:
  recommended_for:
    - "Research studies investigating urban CO2 budgets where both anthropogenic and biogenic components are needed"
    - "Sensitivity analyses exploring photosynthesis model choice on urban net CO2 flux"
  not_recommended_for:
    - "Production simulations until further multi-site validation is completed"
    - "Applications requiring detailed ecosystem carbon accounting (use dedicated vegetation models)"
    - "Sites where vegetation is a negligible fraction of the surface"
  configuration_notes: >-
    EmissionsMethod values encode both the photosynthesis family and the paired
    QF method. The tens digit selects the photosynthesis model: 1x = rectangular
    hyperbola, 2x = non-rectangular hyperbola (Bellucco 2017), 4x = conductance-
    based (Jarvi 2019). The units digit selects the QF method: x1 = L11, x2 = J11,
    x3 = L11_UPDATED, x4 = J19, x5 = J19_UPDATED. For the conductance-based
    methods, the gsmodel parameter controls whether air temperature or modelled
    2 m temperature is used.
  common_pitfalls:
    - "Photosynthesis coefficients (alpha, beta, theta) are vegetation-type-specific and must be calibrated"
    - "The general Bellucco model (3x series) requires identical parameters across vegetation types; weighted averaging is applied otherwise"
    - "Minimum respiration floor prevents unrealistically low values but masks cold-temperature behaviour"
    - "Conductance-based methods (4x) require a compatible gsmodel setting (1-4)"

governance:
  candidate_for_deprecation: false
