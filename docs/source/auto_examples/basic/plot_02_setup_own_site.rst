
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/basic/plot_02_setup_own_site.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_basic_plot_02_setup_own_site.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_basic_plot_02_setup_own_site.py:


Set Up SUEWS for Your Own Site
==============================

Configure SUEWS parameters for a custom research location.

This tutorial demonstrates how to configure SUEWS for your own site using
external forcing data. We use the US-AR1 site (ARM Southern Great Plains,
Oklahoma, USA) as an example - a grassland flux tower site with high-quality
observations.

You will learn to:

1. Load external forcing data from a file
2. Modify surface parameters (land cover, albedo, LAI)
3. Configure site-specific settings (location, measurement height)
4. Run the simulation and compare with observations

**Important**: This tutorial shows the legacy DataFrame approach. For new projects,
consider using YAML configuration files for better structure and validation.

.. GENERATED FROM PYTHON SOURCE LINES 22-35

.. code-block:: Python


    import os
    from pathlib import Path

    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd
    import supy as sp
    from supy import SUEWSSimulation

    # Detect CI environment for reduced computation
    _IS_CI = os.environ.get("CI", "false").lower() == "true"








.. GENERATED FROM PYTHON SOURCE LINES 36-41

Load Sample Data as Template
----------------------------

We start with built-in sample data to get valid default parameters,
then modify them for our target site.

.. GENERATED FROM PYTHON SOURCE LINES 41-50

.. code-block:: Python


    sim = SUEWSSimulation.from_sample_data()
    df_state_init = sim.state_init

    # Create a copy for modification
    df_state_site = df_state_init.copy()

    print("Template data loaded successfully!")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1063: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("dqndt", "0")] = self.dqndt
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1064: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("dqnsdt", "0")] = self.dqnsdt
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1065: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("dt_since_start", "0")] = self.dt_since_start
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1066: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("lenday_id", "0")] = self.lenday_id
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1067: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("qn_av", "0")] = self.qn_av
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1068: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("qn_s_av", "0")] = self.qn_s_av
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1069: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("tair_av", "0")] = self.tair_av
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1070: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("tmax_id", "0")] = self.tmax_id
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1071: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("tmin_id", "0")] = self.tmin_id
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1072: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("tstep_prev", "0")] = self.tstep_prev
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1073: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("snowfallcum", "0")] = self.snowfallcum
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1079: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[(f"hdd_id", f"({i},)")] = hdd
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1079: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[(f"hdd_id", f"({i},)")] = hdd
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1079: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[(f"hdd_id", f"({i},)")] = hdd
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1079: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[(f"hdd_id", f"({i},)")] = hdd
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1063: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("dqndt", "0")] = self.dqndt
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1064: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("dqnsdt", "0")] = self.dqnsdt
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1065: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("dt_since_start", "0")] = self.dt_since_start
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1066: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("lenday_id", "0")] = self.lenday_id
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1067: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("qn_av", "0")] = self.qn_av
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1068: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("qn_s_av", "0")] = self.qn_s_av
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1069: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("tair_av", "0")] = self.tair_av
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1070: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("tmax_id", "0")] = self.tmax_id
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1071: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("tmin_id", "0")] = self.tmin_id
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1072: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("tstep_prev", "0")] = self.tstep_prev
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1073: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[("snowfallcum", "0")] = self.snowfallcum
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1079: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[(f"hdd_id", f"({i},)")] = hdd
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1079: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[(f"hdd_id", f"({i},)")] = hdd
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1079: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[(f"hdd_id", f"({i},)")] = hdd
    /Users/tingsun/conductor/workspaces/suews/taipei/src/supy/data_model/core/state.py:1079: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
      df_state[(f"hdd_id", f"({i},)")] = hdd
    Template data loaded successfully!




.. GENERATED FROM PYTHON SOURCE LINES 51-56

Configure Site Location
-----------------------

Set the geographic coordinates and altitude for the US-AR1 site.
These affect solar geometry calculations and atmospheric corrections.

.. GENERATED FROM PYTHON SOURCE LINES 56-66

.. code-block:: Python


    # US-AR1: ARM Southern Great Plains, Oklahoma, USA
    df_state_site.loc[:, "lat"] = 36.6  # Latitude (degrees)
    df_state_site.loc[:, "lng"] = -97.5  # Longitude (degrees)
    df_state_site.loc[:, "alt"] = 314.0  # Altitude (metres)
    df_state_site.loc[:, "timezone"] = -6  # Central Time (UTC-6)

    print(f"Site: US-AR1 (ARM Southern Great Plains)")
    print(f"Location: lat={df_state_site.lat.values[0]}, lng={df_state_site.lng.values[0]}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Site: US-AR1 (ARM Southern Great Plains)
    Location: lat=[36.6], lng=[-97.5]




.. GENERATED FROM PYTHON SOURCE LINES 67-81

Configure Land Cover Fractions
------------------------------

SUEWS divides the urban surface into 7 land cover types:

- 0: Paved surfaces
- 1: Buildings
- 2: Evergreen trees
- 3: Deciduous trees
- 4: Grass
- 5: Bare soil
- 6: Water

Fractions must sum to 1.0.

.. GENERATED FROM PYTHON SOURCE LINES 81-93

.. code-block:: Python


    # View default surface fractions
    print("Default surface fractions:")
    print(df_state_site.loc[:, "sfr_surf"])

    # Configure for a grassland site (100% grass)
    df_state_site.loc[:, "sfr_surf"] = 0.0  # Use float to preserve dtype
    df_state_site.loc[:, ("sfr_surf", "(4,)")] = 1.0  # 100% grass

    print("\nModified surface fractions (grassland):")
    print(df_state_site.loc[:, "sfr_surf"])





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Default surface fractions:
    ind_dim  (0,)  (1,) (2,)  (3,)  (4,) (5,)  (6,)
    grid                                           
    1        0.43  0.38  0.0  0.02  0.03  0.0  0.14

    Modified surface fractions (grassland):
    ind_dim (0,) (1,) (2,) (3,) (4,) (5,) (6,)
    grid                                      
    1        0.0  0.0  0.0  0.0  1.0  0.0  0.0




.. GENERATED FROM PYTHON SOURCE LINES 94-99

Configure Albedo Parameters
---------------------------

Albedo varies seasonally with vegetation state. We set minimum and maximum
values for grass surfaces.

.. GENERATED FROM PYTHON SOURCE LINES 99-107

.. code-block:: Python


    # Grass albedo range
    df_state_site.albmax_grass = 0.25  # Maximum (dry/dormant grass)
    df_state_site.albmin_grass = 0.18  # Minimum (green grass)
    df_state_site.loc[:, "albgrass_id"] = 0.20  # Initial value

    print(f"Grass albedo: min={df_state_site.albmin_grass.values[0]}, max={df_state_site.albmax_grass.values[0]}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Grass albedo: min=[0.18], max=[0.25]




.. GENERATED FROM PYTHON SOURCE LINES 108-113

Configure LAI and Phenology
---------------------------

Leaf Area Index (LAI) controls vegetation transpiration and varies
seasonally based on temperature accumulation.

.. GENERATED FROM PYTHON SOURCE LINES 113-127

.. code-block:: Python


    # LAI parameters for grass
    df_state_site.loc[:, ("laimax", "(2,)")] = 3.0  # Maximum LAI
    df_state_site.loc[:, ("laimin", "(2,)")] = 0.5  # Minimum LAI
    df_state_site.loc[:, ("lai_id", "(2,)")] = 0.5  # Initial LAI

    # Phenology parameters
    df_state_site.loc[:, ("baset", "(2,)")] = 5  # Base temperature for growth
    df_state_site.loc[:, ("basete", "(2,)")] = 20  # Base temperature for senescence
    df_state_site.loc[:, ("gddfull", "(2,)")] = 1000  # Growing degree days for full leaf
    df_state_site.loc[:, ("sddfull", "(2,)")] = -1000  # Senescence degree days

    print("LAI configured for grass surfaces")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    LAI configured for grass surfaces




.. GENERATED FROM PYTHON SOURCE LINES 128-133

Configure Surface Resistance
----------------------------

Surface resistance controls evapotranspiration. These parameters define
how the canopy responds to environmental conditions.

.. GENERATED FROM PYTHON SOURCE LINES 133-144

.. code-block:: Python


    df_state_site.maxconductance = 20.0  # Maximum stomatal conductance
    df_state_site.g1 = 1.0  # LAI-related parameter
    df_state_site.g2 = 100.0  # Solar radiation parameter
    df_state_site.g3 = 0.5  # Vapour pressure deficit parameter
    df_state_site.g4 = 0.8  # Soil moisture parameter
    df_state_site.g5 = 40.0  # Air temperature parameter
    df_state_site.g6 = 0.02  # Kdown parameter

    print("Surface resistance parameters configured")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Surface resistance parameters configured




.. GENERATED FROM PYTHON SOURCE LINES 145-152

Configure Measurement Height
----------------------------

Set the height where forcing variables are measured. This affects
the aerodynamic calculations.
Note: z must be above the displacement height (zdm), which is typically
about 2/3 of building height. Use 40m for typical sites with buildings.

.. GENERATED FROM PYTHON SOURCE LINES 152-161

.. code-block:: Python


    df_state_site.z = 40.0  # Measurement height (metres)

    # Disable anthropogenic heat (rural site)
    df_state_site.popdensdaytime = 0
    df_state_site.popdensnighttime = 0

    print(f"Measurement height: {df_state_site.z.values[0]} m")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Measurement height: [40.] m




.. GENERATED FROM PYTHON SOURCE LINES 162-166

Validate Configuration
----------------------

Use the built-in validation to check for parameter issues.

.. GENERATED FROM PYTHON SOURCE LINES 166-170

.. code-block:: Python


    df_state_validated = sp.check_state(df_state_site)
    print("Configuration validation complete")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Configuration validation complete




.. GENERATED FROM PYTHON SOURCE LINES 171-176

Load External Forcing Data
--------------------------

Load meteorological observations from the US-AR1 site.
The forcing file contains hourly observations for 2010.

.. GENERATED FROM PYTHON SOURCE LINES 176-205

.. code-block:: Python


    # Determine script directory (works both standalone and in sphinx-gallery)
    try:
        _script_dir = Path(__file__).resolve().parent
    except NameError:
        # sphinx-gallery context - working directory is set to script's source directory
        _script_dir = Path.cwd()

    # Path to forcing data
    path_forcing = _script_dir / "data" / "US-AR1_2010_data_60.txt"
    df_forcing_raw = sp.util.read_forcing(str(path_forcing), tstep_mod=None)

    # Use reduced period for CI builds
    if _IS_CI:
        df_forcing_site = df_forcing_raw.loc["2010-01":"2010-03"]
    else:
        df_forcing_site = df_forcing_raw.loc["2010-01":"2010-06"]

    # Clean forcing data: clip small negative kdown values to 0
    # (common measurement noise from pyranometers at night)
    df_forcing_site = df_forcing_site.copy()
    df_forcing_site["kdown"] = df_forcing_site["kdown"].clip(lower=0)

    # Validate forcing data
    sp.check_forcing(df_forcing_site)

    print(f"Forcing period: {df_forcing_site.index[0]} to {df_forcing_site.index[-1]}")
    print(f"Time steps: {len(df_forcing_site)}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Forcing period: 2010-01-01 01:00:00 to 2010-06-30 23:00:00
    Time steps: 4343




.. GENERATED FROM PYTHON SOURCE LINES 206-210

Visualise Forcing Data
----------------------

Examine the key meteorological variables that drive the simulation.

.. GENERATED FROM PYTHON SOURCE LINES 210-234

.. code-block:: Python


    list_var = ["kdown", "Tair", "RH", "U", "rain"]
    dict_labels = {
        "kdown": r"$K_\downarrow$ (W m$^{-2}$)",
        "Tair": r"$T_{air}$ ($^\circ$C)",
        "RH": "RH (%)",
        "U": r"$U$ (m s$^{-1}$)",
        "rain": "Rain (mm)",
    }

    # Resample to hourly for clearer plots
    df_plot = df_forcing_site[list_var].resample("1h").mean()
    df_plot["rain"] = df_forcing_site["rain"].resample("1h").sum()

    fig, axes = plt.subplots(5, 1, figsize=(10, 10), sharex=True)
    for ax, var in zip(axes, list_var):
        df_plot[var].plot(ax=ax)
        ax.set_ylabel(dict_labels[var])
    axes[-1].set_xlabel("Date")
    fig.suptitle("Forcing Data Overview", fontsize=12, y=1.02)
    plt.tight_layout()
    plt.show()





.. image-sg:: /auto_examples/basic/images/sphx_glr_plot_02_setup_own_site_001.png
   :alt: Forcing Data Overview
   :srcset: /auto_examples/basic/images/sphx_glr_plot_02_setup_own_site_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 236-240

Run Simulation
--------------

Create a simulation with the modified configuration and run it.

.. GENERATED FROM PYTHON SOURCE LINES 240-249

.. code-block:: Python


    sim_site = SUEWSSimulation.from_state(df_state_validated).update_forcing(df_forcing_site)
    sim_site.run(logging_level=90)

    df_output = sim_site.results
    df_state_final = sim_site.state_final

    print(f"Simulation complete: {len(df_output)} timesteps")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Simulation complete: 4343 timesteps




.. GENERATED FROM PYTHON SOURCE LINES 250-254

Analyse Energy Balance
----------------------

Examine the simulated surface energy balance components.

.. GENERATED FROM PYTHON SOURCE LINES 254-278

.. code-block:: Python


    df_suews = df_output["SUEWS"]
    grid = df_state_site.index[0]
    df_results = df_suews.loc[grid]

    # Daily means
    df_daily = df_results.resample("1D").mean()

    dict_var_disp = {
        "QN": r"$Q^*$",
        "QS": r"$\Delta Q_S$",
        "QE": "$Q_E$",
        "QH": "$Q_H$",
    }

    fig, ax = plt.subplots(figsize=(10, 4))
    df_daily[["QN", "QS", "QE", "QH"]].rename(columns=dict_var_disp).plot(ax=ax)
    ax.set_xlabel("Date")
    ax.set_ylabel(r"Flux (W m$^{-2}$)")
    ax.set_title("Daily Mean Surface Energy Balance")
    ax.legend()
    plt.tight_layout()
    plt.show()




.. image-sg:: /auto_examples/basic/images/sphx_glr_plot_02_setup_own_site_002.png
   :alt: Daily Mean Surface Energy Balance
   :srcset: /auto_examples/basic/images/sphx_glr_plot_02_setup_own_site_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 279-283

Examine LAI Dynamics
--------------------

Check how LAI evolves through the simulation based on temperature accumulation.

.. GENERATED FROM PYTHON SOURCE LINES 283-297

.. code-block:: Python


    df_daily_state = df_output.loc[grid, "DailyState"].dropna(how="all").resample("1D").mean()

    if "LAI_Grass" in df_daily_state.columns and not df_daily_state["LAI_Grass"].dropna().empty:
        fig, ax = plt.subplots(figsize=(10, 3))
        df_daily_state["LAI_Grass"].plot(ax=ax)
        ax.set_xlabel("Date")
        ax.set_ylabel("LAI (m$^2$ m$^{-2}$)")
        ax.set_title("Grass LAI Evolution")
        plt.tight_layout()
        plt.show()
    else:
        print("LAI_Grass not available or empty in DailyState output")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    LAI_Grass not available or empty in DailyState output




.. GENERATED FROM PYTHON SOURCE LINES 298-302

Surface Resistance Analysis
---------------------------

Examine how surface resistance varies with environmental conditions.

.. GENERATED FROM PYTHON SOURCE LINES 302-317

.. code-block:: Python


    ser_rs = df_results["RS"]

    # Daily median resistance (filter extreme values)
    df_rs_daily = ser_rs.between_time("10:00", "16:00").resample("1D").median()
    df_rs_daily = df_rs_daily[df_rs_daily < 500]  # Filter outliers

    fig, ax = plt.subplots(figsize=(10, 3))
    df_rs_daily.plot(ax=ax)
    ax.set_xlabel("Date")
    ax.set_ylabel(r"$r_s$ (s m$^{-1}$)")
    ax.set_title("Daily Median Surface Resistance (10:00-16:00)")
    plt.tight_layout()
    plt.show()




.. image-sg:: /auto_examples/basic/images/sphx_glr_plot_02_setup_own_site_003.png
   :alt: Daily Median Surface Resistance (10:00-16:00)
   :srcset: /auto_examples/basic/images/sphx_glr_plot_02_setup_own_site_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 318-339

Summary
-------

This tutorial demonstrated how to configure SUEWS for a custom site:

1. **Location**: Set latitude, longitude, and altitude
2. **Land cover**: Configure surface fractions (sum to 1.0)
3. **Vegetation**: Set albedo, LAI, and phenology parameters
4. **Surface resistance**: Configure stomatal conductance parameters
5. **Forcing data**: Load and validate meteorological observations

**Key parameters to consider:**

- Surface fractions determine which surface types are active
- LAI parameters control vegetation transpiration seasonally
- Surface resistance parameters tune the Jarvis model response
- Measurement height affects aerodynamic calculations

**Next steps:**

- :doc:`plot_03_impact_studies` - Sensitivity analysis and scenario modelling


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 8.074 seconds)


.. _sphx_glr_download_auto_examples_basic_plot_02_setup_own_site.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_02_setup_own_site.ipynb <plot_02_setup_own_site.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_02_setup_own_site.py <plot_02_setup_own_site.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_02_setup_own_site.zip <plot_02_setup_own_site.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
